# Простая микросервисная реализация бэкэнда на GO #

## Описание ##

Проект является бэкэндом в рамках которого демонстрируются навыки работы с микросервисной архитектурой. Является референсом для реализации более сложных проектов. Содержит пример разворачивания микросервисной архитектуры с использованием хранилища и систем мониторинга производительности.

## Технологический стэк ##

- __Go 1.24+__ - основной язык разработки
- __Gorilla Mux__ - роутинг HTTP запросов
- __MinIO__ - S3-совместимое объектное хранилище
- __Prometheus__ - сбор и хранение метрик
- __Grafana__ - визуализация и дашборды
- __Docker Compose__ - оркестрация контейнеров

## Архитектура ##

```text
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Клиенты       │────│   Go API Server │────│     MinIO       │
│   (HTTP/REST)   │    │   (:9898)       │    │  (Хранилище)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                               │
                               ▼
                    ┌─────────────────────┐
                    │   Prometheus        │◄───┐
                    │   (Метрики)         │    │
                    └─────────────────────┘    │
                               │               │
                               ▼               │
                    ┌─────────────────────┐    │
                    │   Grafana           │────┘
                    │   (Визуализация)    │
                    └─────────────────────┘
```
Для простоты в проекте отсутстует работа с БД. Вместо этого все данные хранятся в одном JSON файле в MinIO.

## Доступные сервисы ##
|Сервис| Порт | Описание |
|------|------|----------|
| Go Application | 9898 | Основной API сервер |
| Prometheus | 9090 | Система мониторинга и сбора метрик |
| Grafana | 	3000 | Визуализация метрик и дашборды |
| MinIO Console | 5002 | Управление объектным хранилищем |
| MinIO API | 5001 | S3-совместимое API |

## API Endpoints ##

### Пользователи ###
- GET /api/users - Получить всех пользователей
- POST /api/users - Добавить нового пользователя
- GET /api/users/{id} - Получить пользователя по ID
- PUT /api/users/{id} - Обновить пользователя
- DELETE /api/users/{id} - Удалить пользователя

### Тестирование и мониторинг ###

- GET /test - Тестовый endpoint
- GET /metrics - Prometheus метрики
- GET /health - Health check

##  Docker развертывание ##

### Запуск всех сервисов ###
```bash
docker-compose up -d
```
### Остановка ###
```bash
docker-compose down
```
### Просмотр логов ###
```bash
docker-compose logs -f app
docker-compose logs -f prometheus
docker-compose logs -f grafana
```

## Мониторинг и метрики ##

### Дашборды Grafana ###

Включены готовые дашборды:
1. RPS график - запросы в секунду
2. Latency график - время ответа
3. Error Rate - процент ошибок
4. Active Requests - запросы в обработке

## Нагрузочное тестирование ##

```bash
# Базовая нагрузка
./wrk -t12 -c500 -d60s http://localhost:9898/api/users

# Проверка rate limiting
./wrk -t4 -c100 -d30s http://localhost:9898/api/users
```

### Интерпретация результатов ###
- Успешные запросы: ~1000 RPS (ограничено rate limiter)
- 429 ошибки: при превышении лимита
- Latency: стабильная при нагрузке

## Структура проекта ##
```text
go-microservice/
├── main.go                 # Точка входа
├── docker-compose.yml      # Docker конфигурация
├── Dockerfile             # Образ приложения
├── prometheus/            # Конфигурация Prometheus
│   └── prometheus.yml
├── grafana/               # Конфигурация Grafana
│   ├── provisioning/
│   └── dashboards/
├── handlers/              # HTTP хендлеры
├── repository/            # Работа с MinIO
├── metrics/               # Prometheus метрики
├── utils/                 # Утилиты и утилитарные функции
└── models/                # Модели данных
```

